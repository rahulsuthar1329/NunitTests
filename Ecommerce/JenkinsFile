// pipeline {
//     agent any

//     stages {
//         stage('Build Code')
//         {
//             steps {
//                 bat script: "dotnet restore ."
//                 bat script: "dotnet test -e \"BrowserName=${browserName}\""
//             }
//         }
//     }
// }

pipeline {
  agent any

  stages {
    stage('Build Code') {
      steps {
        script: // Use 'sh' only for complex shell commands
          sh """
          source /etc/os-release
          ID=${ID}
          VERSION_ID=${VERSION_ID}
          
          wget https://packages.microsoft.com/config/$ID/$VERSION_ID/packages-microsoft-prod.deb -O packages-microsoft-prod.deb
          sudo dpkg -i packages-microsoft-prod.deb
          rm packages-microsoft-prod.deb
          sudo apt update
          sudo apt install dotnet-sdk-8.0
          dotnet restore .
          dotnet test -e "BrowserName=${browserName}"
          """
      }
    }
  }
}